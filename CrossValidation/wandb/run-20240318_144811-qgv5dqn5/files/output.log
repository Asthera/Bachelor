Traceback (most recent call last):
  File "/Users/volodimir/Downloads/Bachelor/CrossValidation/training.py", line 97, in <module>
    train()
  File "/Users/volodimir/Downloads/Bachelor/CrossValidation/training.py", line 38, in train
    train_dataset, val_dataset, test_dataset = build_datasets(fold_json_path,
                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/volodimir/Downloads/Bachelor/CrossValidation/utils/build.py", line 56, in build_datasets
    val_dataset = FramesDataset(json_path, img_dir, init_transform, None, output_transform, subset="val",
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/volodimir/Downloads/Bachelor/CrossValidation/data/dataset.py", line 26, in __init__
    train, val = train_test_split(self.frames_json, test_size=val, random_state=42)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/volodimir/anaconda3/envs/Global/lib/python3.11/site-packages/sklearn/model_selection/_split.py", line 2562, in train_test_split
    n_train, n_test = _validate_shuffle_split(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/volodimir/anaconda3/envs/Global/lib/python3.11/site-packages/sklearn/model_selection/_split.py", line 2236, in _validate_shuffle_split
    raise ValueError(
ValueError: With n_samples=0, test_size=0.2 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
{'program': 'training.py', 'name': 'with_cross_val', 'method': 'grid', 'metric': {'goal': 'minimize', 'name': 'test_loss'}, 'parameters': {'transform': {'values': ['none', 'random_erasing_delete', 'random_erasing_random', 'random_crop', 'random_horizontal_flip', 'random_vertical_flip', 'random_rotation', 'color_jitter', 'random_noise(0.4, 0.5)', 'random_noise(0, 0.1)']}, 'fold': {'values': ['fold_0', 'fold_1', 'fold_2', 'fold_3', 'fold_4']}, 'batch_size': {'values': [64]}}, 'folds_path': 'metadata_folds/kkui-lung-bline-lumify:latest/video', 'optimizer': 'adam', 'learning_rate': 0.0001, 'criterion': 'cross-entropy', 'img_dir': '/Volumes/LaCie/Macbook/Bachelor/CrossValidation/', 'fc_layer_size': 512, 'number_of_classes': 2, 'patience': 5, 'early_stopping': True, 'epochs': 30, 'pretrained': True, 'save_weights': True, 'init_transform': ['transform_resize(600)', 'transform_pad(600)'], 'output_transform': 'none', 'experiment_class': 'b_line', 'is_validating': True, 'val_dist': 0.2, 'device': 'mps', 'arch': 'resnet18', 'comment': 'testing with refactored code', 'batch_size': 64, 'fold': 'fold_2', 'transform': 'random_noise(0.4, 0.5)'}
{'program': 'training.py', 'name': 'with_cross_val', 'method': 'grid', 'metric': {'goal': 'minimize', 'name': 'test_loss'}, 'parameters': {'transform': {'values': ['none', 'random_erasing_delete', 'random_erasing_random', 'random_crop', 'random_horizontal_flip', 'random_vertical_flip', 'random_rotation', 'color_jitter', 'random_noise(0.4, 0.5)', 'random_noise(0, 0.1)']}, 'fold': {'values': ['fold_0', 'fold_1', 'fold_2', 'fold_3', 'fold_4']}, 'batch_size': {'values': [64]}}, 'folds_path': 'metadata_folds/kkui-lung-bline-lumify:latest/video', 'optimizer': 'adam', 'learning_rate': 0.0001, 'criterion': 'cross-entropy', 'img_dir': '/Volumes/LaCie/Macbook/Bachelor/CrossValidation/', 'fc_layer_size': 512, 'number_of_classes': 2, 'patience': 5, 'early_stopping': True, 'epochs': 30, 'pretrained': True, 'save_weights': True, 'init_transform': ['transform_resize(600)', 'transform_pad(600)'], 'output_transform': 'none', 'experiment_class': 'b_line', 'is_validating': True, 'val_dist': 0.2, 'device': 'mps', 'arch': 'resnet18', 'comment': 'testing with refactored code', 'batch_size': 64, 'fold': 'fold_2', 'transform': 'random_noise(0.4, 0.5)'}
['transform_resize(600)', 'transform_pad(600)']
random_noise(0.4, 0.5)
none
Transforms built
Compose(
    <transforms.resize.TransformResize object at 0x152109110>
    <transforms.pad.TransformPad object at 0x14f027210>
) Compose(
    <transforms.random_noise.RandomNoise object at 0x151ec29d0>
) Compose(
    None
)